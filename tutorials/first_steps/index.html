<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Your Racecar&#39;s First &#39;&#39;Steps&#39;&#39; - MuSHR: The UW Open Racecar Project</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://mushr.io/favicon.png">

  
  
  <link rel="stylesheet" href="/css/style.min.9880904470a1126028d45484ed2efa17a2e05dfc4557256736946a0cc95d1bc0.css">
  

  

</head>

<body class='page page-tutorials-single'>
  
<div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    <li class="menu-item-quickstart">
      <a href="/tutorials/quickstart/"><span>Quickstart</span></a>
    </li>
    <li class="menu-item-about">
      <a href="/about/"><span>About</span></a>
    </li>
    <li class="menu-item-docs">
      <a href="https://github.com/prl-mushr/mushr#component-documentation"><span>Docs</span></a>
    </li>
    <li class="menu-item-hardware">
      <a href="/hardware/"><span>Hardware</span></a>
    </li>
    <li class="menu-item-tutorials active">
      <a href="/tutorials/"><span>Tutorials</span></a>
    </li>
    <li class="menu-item-press">
      <a href="/press/"><span>Press</span></a>
    </li>
    <li class="menu-item-team">
      <a href="https://personalrobotics.cs.washington.edu/people/"><span>Team</span></a>
    </li>
    <li class="menu-item-forum">
      <a href="https://spectrum.chat/mushr"><span>Community Forum</span></a>
    </li>
    <li class="menu-item-contact">
      <a href="/contact/"><span>Contact</span></a>
    </li>
  </ul>
</div>

  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://mushr.io/"><img alt="Figurit Homepage" src="https://mushr.io/imgs/mushr-logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://mushr.io/"><img alt="Figurit Homepage" src="https://mushr.io/imgs/mushr-logo.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    <li class="menu-item-quickstart">
      <a href="/tutorials/quickstart/"><span>Quickstart</span></a>
    </li>
    <li class="menu-item-about">
      <a href="/about/"><span>About</span></a>
    </li>
    <li class="menu-item-docs">
      <a href="https://github.com/prl-mushr/mushr#component-documentation"><span>Docs</span></a>
    </li>
    <li class="menu-item-hardware">
      <a href="/hardware/"><span>Hardware</span></a>
    </li>
    <li class="menu-item-tutorials active">
      <a href="/tutorials/"><span>Tutorials</span></a>
    </li>
    <li class="menu-item-press">
      <a href="/press/"><span>Press</span></a>
    </li>
    <li class="menu-item-team">
      <a href="https://personalrobotics.cs.washington.edu/people/"><span>Team</span></a>
    </li>
    <li class="menu-item-forum">
      <a href="https://spectrum.chat/mushr"><span>Community Forum</span></a>
    </li>
    <li class="menu-item-contact">
      <a href="/contact/"><span>Contact</span></a>
    </li>
  </ul>
</div>

    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" role="presentation" aria-label="mobile menu trigger">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>
    
<div class="container pb-6 pt-6 pt-md-10 pb-md-10">
  <div class="row justify-content-start">
    <div class="col-12 col-md-8">
      <div class="tutorial tutorial-single">
        <h1 class="title">Your Racecar&#39;s First &#39;&#39;Steps&#39;&#39;</h1>
        <div class="content"> 
          
          <p>Get your car started and teleop running</p> 
          
          <h4 class="properties">Beginner Tutorial | Expected duration is 15 - 30 minutes</h4> 
          
          <h2> By: <a href=https://www.mattschmittle.com/>Matt Schmittle</a></h2>  
<figure>
    <img src="/tutorials/first_steps/firststep.jpg" width="800"/> 
</figure>
 <br>                           
<h3 id="introduction">Introduction</h3>
<p>This tutorial will get your car up and running teleoperation.</p>
<h3 id="goal">Goal</h3>
<p>To get you driving your car around in teleop.</p>
<h3 id="requirements">Requirements</h3>
<ul>
<li>Complete the <a href="/hardware/build_instructions">hardware</a> setup with your car</li>
<li>Complete the <a href="/tutorials/quickstart">quickstart</a> tutorial. (Required for rviz)</li>
<li>A desktop/laptop computer that can ssh into the car.</li>
<li>Ethernet Cable</li>
<li>Monitor (Wi-Fi Setup Only)</li>
<li>HDMI/Display Cable (Wi-Fi Setup Only)</li>
<li>USB Keyboard/Mouse (Wi-Fi Setup Only)</li>
</ul>
<h2 id="booting-up">Booting Up</h2>
<p>Make sure your sd card is plugged into your Jetson Nano and flush, this should be done from the hardware tutorial. If you have an AC to 5V power adapter you can plug that into the barrel connector on the USB port side of the Jetson Nano. If not, place a battery in the right side of the car and plug the connector into the matching connector going into the top half of the car. Plug in the right angled barrel connector into the Jetson Nano. The green light on the right side should turn on. The correct configuration is shown below.</p>
<figure>
    <img src="/tutorials/first_steps/plugged_in.jpg"
         alt="Everything plugged in correctly. Notice the barrel connector in the top right, the battery in the right slot, and the green light in the top left." width="600"/> <figcaption>
            <p>Everything plugged in correctly. Notice the barrel connector in the top right, the battery in the right slot, and the green light in the top left.</p>
        </figcaption>
</figure>

<p>By default your car creates it on network called <code>ROBOT AP</code>. On your separate computer, connect to this network and ssh into your car.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ssh robot@10.42.0.1 -X</code></pre></div>
<p><strong>Password:</strong> prl_robot</p>
<p>If you experience any errors, make sure you are connected to <code>ROBOT AP</code> and you typed the above properly.</p>
<h2 id="configure-user--hostname">Configure User &amp; Hostname</h2>
<p>Your connected! So let's change the password and hostname. This section is all done on the robot side. First let's change the password.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ passwd </code></pre></div>
<p>Enter prl_robot as the current password and then type your new password with the prompts. Now let's configure the hostname, it is currently set to goose. Open the hostname file.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ sudo gedit /etc/hostname </code></pre></div>
<p>You will be prompted to enter the password. Change goose to whatever you want to use and save &amp; exit. Similarly open the <code>/etc/hosts</code> file.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ sudo gedit /etc/hosts</code></pre></div>
<p>And replace any goose with your new hostname. Save &amp; exit. Reboot the car, to see the effect. Note: you will have to ssh in again.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ sudo reboot</code></pre></div>
<h2 id="update-repos">Update Repos</h2>
<p>Because mushr is always updating, you may have outdated code on your image. To fix this just enter <code>~/catkin_ws/src/mushr</code> and pull via vcstool. For this to work, you need to give your car access to the internet. The easiest way to do this is by plugging an ethernet cable from an ethernet port on your home router to the car. If you don't have an ethernet cable, you can plug in a monitor, mouse, and keyboard into the Jetson Nano and connect the car to a wifi network.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">cd</span> ~/catkin_ws/src/mushr <span class="o">&amp;&amp;</span> vcs pull -n</code></pre></div>
<p>Note: If you edited mushr source code, this will be overwritten. You can instead pull repos individually</p>
<h2 id="configure-visualization">Configure Visualization</h2>
<p>Visualization is important for seeing what your car is thinking such as which trajectory it will follow or its current position in the map. On your laptop with rviz make sure to set your <code>default.rviz</code> to ours found in <code>mushr/mushr_utils/rviz/default.rviz</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ cp ~/catkin_ws/src/mushr/mushr_utils/rviz/default.rviz ~/.rviz/</code></pre></div>
<p>Set the <code>ROS_IP</code> to your IP. Your IP can be found in a variety of ways: <a href="https://www.howtogeek.com/howto/17012/how-to-find-your-ip-address-in-ubuntu/">Linux</a>, <a href="http://osxdaily.com/2010/08/08/lan-ip-address-mac/">Mac</a>, <a href="https://kb.netgear.com/20878/Finding-your-IP-address-without-using-the-command-prompt">Windows</a>.</p>
<p>Set <code>ROS_IP</code> with:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">export</span> <span class="nv">ROS_IP</span><span class="o">=</span>YOUR-IP</code></pre></div>
<p>Set the <code>ROS_MASTER_URI</code> to the IP of the car.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">export</span> <span class="nv">ROS_MASTER_URI</span><span class="o">=</span>http://10.42.0.1:11311</code></pre></div>
<p>You are configured! Wait till teleop is running to launch <code>rviz</code> on your laptop.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ rviz</code></pre></div>
<p>If you get errors make sure the following are correct:</p>
<ul>
<li>Teleop is running</li>
<li>Your laptop is connnected properly<br>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ rostopic list</code></pre></div>
This should output a bunch of topics. If not, check your <code>ROS_MASTER_URI</code> and <code>ROS_IP</code> to ensure they are correct.</li>
</ul>
<h2 id="launch-teleop-the-easy-way">Launch Teleop the Easy Way</h2>
<p>To do this you need a push button on the front of the car. This method turns on teleop whenever you hold the button on teleop. By default it is disabled. The following will enable it. First, turn on the car by plugging a battery into the top connector. Then connect to the <code>ROBOT_AP</code> WIFI network. Then ssh into the car.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ssh robot@10.42.0.1 -X</code></pre></div>
<p>Next, we need to uncomment the startup command for the button teleop. Open <code>/etc/rc.local</code> and uncomment line 9.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ sudo vim /etc/rc.local</code></pre></div>
<p>Use the default password. Now you can turnoff the car by running the following and unplugging the batterie.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ sudo shutdown now</code></pre></div>
<p>Turn on the car and vesc by plugging their batteries in. Hold down the front button as the car is starting. After a minute or so the lidar should start spinning indicating teleop is running.</p>
<h2 id="launch-teleop-the-hard-way">Launch Teleop the Hard Way</h2>
<p>This is better for debugging your code. Turn on the car and vesc by plugging their batteries in. This will involve multiple windows. You can either make a bunch of windows on your laptop and ssh from each of them or use <a href="https://www.hamvocke.com/blog/a-quick-and-easy-guide-to-tmux/">tmux</a> from one window. Tmux is installed on the car image. First, ssh into the car. Then start <code>roscore</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ roscore</code></pre></div>
<p>In a new window, ssh into the car.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ssh robot@10.42.0.1 -X</code></pre></div>
<p>And launch teleop.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ roslaunch mushr_base teleop.launch</code></pre></div>
<p>You should see the lidar spinning and be able to steer with the controller. While holding down the left bumper, use the left joystick to throttle, and the right joystick to turn. See diagram below.</p>
<figure>
    <img src="/tutorials/first_steps/teleop_controls.png" width="350"/> 
</figure>

<h2 id="setup-wi-fi-optional">Setup Wi-Fi (Optional)</h2>
<p>If you want to install additional software on the car, or be able to use the internet on your laptop while connected to the car then you will want to set the car up with a static IP instead of it's own network. To do this, you will need to plug a monitor, keyboard, and mouse into the car. The keyboard/mouse can go in any of the USB ports, Wi-Fi setup does not require the sensors to be connected.</p>
<p>Once hooked up, you should see the login screen or the desktop. Login using your new password. Then use the mouse to click on the Wi-Fi icon in the top right. Disconnect from <code>ROBOT_AP</code>. Then open the connection manager.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ sudo nm-connection-editor</code></pre></div>
<p>Click on <strong>Robot AP</strong> then the <strong>General</strong> Tab. Uncheck <strong>Automatically connect to this network when it is available</strong>. Exit.</p>
<p>Open <code>/etc/modprobe.d/bcmdhd.conf</code> with sudo privileges.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ sudo gedit /etc/modprobe.d/bcmdhd.conf</code></pre></div>
<p>If the second line (<code>options bcmdhd op_mode=2</code>) is not commented out then comment it out (<code>#options bcmdhd op_mode=2</code>), save the file and reboot the Nano. Otherwise, just close the file.</p>
<p>Connect to the network that the robot should have a static IP on. Do this by clicking on the opposing arrows symbol in the top right hand corner of the Ubuntu GUI and inspecting the Wi-Fi network list. If your robot is already connected to the correct network, then proceed to the next step. If it is already connected but to the wrong network, click <em>Disconnect</em> and then allow the Wi-Fi network list to refresh. Once the desired network appears in the Wi-Fi network list, click on it to connect. If the network does not appear in the Wi-Fi list, try using the <strong>Connect to Hidden Wi-Fi Network...</strong> option.</p>
<p>Open the network connection editor again.</p>
<p>Highlight the connection that corresponds to the network the robot should be connected to and click <strong>Edit...</strong>. The connection should have the same name as the network if the robot has never connected to this network before. If the robot has connected to this network before, it might have the same name but post-fixed with a number. If this is the case, choose the one with the highest post-fixed number.</p>
<p>Click on the <strong>General</strong> tab and check that <strong>Automatically connect to this network when it is available</strong> and <strong>All users may connect to thisnetwork</strong> are enabled.</p>
<figure>
    <img src="/tutorials/first_steps/general.png"
         alt="General tab with auto connect set" width="600"/> <figcaption>
            <p>General tab with auto connect set</p>
        </figcaption>
</figure>

<p>Click on the <strong>Wi-Fi</strong> tab. Make sure that the <strong>SSID:</strong> field is set to be the name of the network that the robot will have a static IP on. For example, it could be <em>University of Washington</em>. Make sure that the <strong>Mode:</strong> dropdown is set to <strong>Client</strong>. In the <strong>BSSID:</strong> dropdown, choose the last option. In the <strong>Device:</strong> dropdown, choose the last option.</p>
<figure>
    <img src="/tutorials/first_steps/wifi.png"
         alt="Wi-Fi tab with BSSID and SSID set" width="600"/> <figcaption>
            <p>Wi-Fi tab with BSSID and SSID set</p>
        </figcaption>
</figure>

<p>Click on the <strong>Wi-Fi Security</strong> tab. Check that the <strong>Security:</strong> dropdown is set to <strong>None</strong>.</p>
<p>Click on the <strong>IPv4 Settings</strong> tab. Set the following fields:</p>
<ul>
<li><strong>Method:</strong> dropdown to be <strong>Manual</strong>.</li>
<li>Click <strong>Add</strong>. Under <strong>Address</strong>, enter:
<ul>
<li>The Static IP: for example <code>172.16.77.Z</code>.</li>
<li>Netmask: for example <code>255.255.255.0</code>.</li>
<li>Gateway: for example <code>172.16.77.100</code>.<br>
<code>Z</code> is usually the robot number on the car, but it's up to you!</li>
</ul>
</li>
<li><strong>DNS servers:</strong> field, enter <code>8.8.8.8</code>.</li>
</ul>
<figure>
    <img src="/tutorials/first_steps/ipv4.png"
         alt="IPv4 tab with an example IP setup" width="600"/> <figcaption>
            <p>IPv4 tab with an example IP setup</p>
        </figcaption>
</figure>

<p>Click the <strong>Save</strong> button and close the connection editor.</p>
<p>Edit <code>/home/robot/.bashrc</code> editing the line that sets the <code>ROS_IP</code> (near end of file). Alter this line so that the <code>ROS_IP</code> is set to the static ip, for example <code>172.16.77.Z</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ gedit ~/.bashrc</code></pre></div>
<p>Alternatively if you know the network interface, you can use the command (should be <code>wlan0</code> interface on the Jetson):</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">export</span> <span class="nv">ROS_IP</span><span class="o">=</span><span class="k">$(</span>ifconfig wlan0 <span class="p">|</span> awk /inet<span class="se">\ </span>/<span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span></code></pre></div>
<p>Reboot the Nano.</p>
<p>After the Jetson reboots, verify that the robot has obtained the expected static ip.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ifconfig</code></pre></div>
<h3 id="logging-in">Logging In</h3>
<p>Once the Nano has fully booted, it will connect to the existing network at the specified static ip. You should then be able to ssh into it with the static IP you set earlier.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ssh robot@172.16.77.Z<span class="sb">`</span></code></pre></div>
<h2 id="next-steps">Next Steps</h2>
<p>To learn about programming the car continue to the <a href="/tutorials/intro-to-ros">Intro to ROS Tutorial</a></p>

        </div>
      </div>
    </div>
  </div>
</div>
<div class="strip strip-primary-gradient-top-bottom">
  <div class="container pt-3 pb-3 pt-md-6 pb-md-3 px-2">
    <div class="row justify-content-left citation-row">
        <h1 id="citation">Citation</h1>
        <p>If you plan to use any part of the the MuSHR platform, including tutorials, codebase, or hardware instructions for a project or paper, please cite 
        <em><a href="https://arxiv.org/abs/1908.08031">MuSHR: A Low-Cost,
        Open-Source Robotic Racecar for Education and Research
        </a></em>:</p></font>
        <div class="highlight"><pre class="chroma">@article{srinivasa2019mushr,
 title={{M}u{SHR}: {A} Low-Cost, Open-Source Robotic Racecar for Education and Research},
 author={Srinivasa, Siddhartha S. and Lancaster, Patrick and Michalove, Johan and Schmittle, Matt and Summers, Colin and Rockett, Matthew and Smith, Joshua R. and Chouhury, Sanjiban and Mavrogiannis, Christoforos and Sadeghi, Fereshteh},
 journal={CoRR},
 volume={abs/1908.08031},
 year={2019}
}
</pre></div>
        <p><br></p>
    </div>
  </div>
</div>


  </div>

  <div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="footer-inner">
          <h3 class="footer-title">MuSHR: The UW Open Racecar Project</h3>
          <ul>
            
            
            <li class="menu-item-forum"><a href="https://spectrum.chat/mushr">Community Forum</a></li>
            
            <li class="menu-item-contact"><a href="/contact/">Contact</a></li>
            
            <li class="menu-item-home"><a href="/">Home</a></li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            
          </ul>
          <ul>
            <li class="prl">Made with <font color="#FF1690">♥</font> at the <a href="https://personalrobotics.cs.washington.edu/">Personal Robotics Lab</a></li>
          </ul>
          <ul>
            <li class="prl">Website by <a href="https://micha.love/"><font color="#36CDC4">Johan</font></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>


  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bf1e1f7ae8e03db5f012356e825843facdff51c0a559cb0d27fe2bbe1db405c2.js"></script>
  

  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146151202-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());
  gtag('config', 'UA-146151202-1');
</script>




</body>

</html>