<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Multi-Agent Coordination Planner for Multi-Goal Tasks - MuSHR: The UW Open Racecar Project</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://mushr.io/favicon.png><link rel=stylesheet href=/css/style.min.d6c2c7df4a2b74e47c295ee499fec19eb99dfe63f90766a829090f557e381bdc.css></head><body class='page page-tutorials-single'><div id=main-menu-mobile class=main-menu-mobile><ul><li class=menu-item-quickstart><a href=/tutorials/noetic_quickstart/><span>Quickstart</span></a></li><li class=menu-item-about><a href=/about/><span>About</span></a></li><li class=menu-item-docs><a href=https://github.com/prl-mushr/mushr#component-documentation><span>Docs</span></a></li><li class=menu-item-hardware><a href=/hardware/><span>Hardware</span></a></li><li class="menu-item-tutorials active"><a href=/tutorials/><span>Tutorials</span></a></li><li class=menu-item-press><a href=/press/><span>Press</span></a></li><li class=menu-item-team><a href=https://personalrobotics.cs.washington.edu/people/><span>Team</span></a></li><li class=menu-item-forum><a href=https://github.com/prl-mushr/mushr/discussions><span>Community Forum</span></a></li><li class=menu-item-contact><a href=/contact/><span>Contact</span></a></li></ul></div><div class=wrapper><div class=header><div class=container><div class=logo><a href=https://mushr.io/><img alt="Figurit Homepage" src=https://mushr.io/imgs/mushr-logo.svg></a></div><div class=logo-mobile><a href=https://mushr.io/><img alt="Figurit Homepage" src=https://mushr.io/imgs/mushr-logo.svg></a></div><div id=main-menu class=main-menu><ul><li class=menu-item-quickstart><a href=/tutorials/noetic_quickstart/><span>Quickstart</span></a></li><li class=menu-item-about><a href=/about/><span>About</span></a></li><li class=menu-item-docs><a href=https://github.com/prl-mushr/mushr#component-documentation><span>Docs</span></a></li><li class=menu-item-hardware><a href=/hardware/><span>Hardware</span></a></li><li class="menu-item-tutorials active"><a href=/tutorials/><span>Tutorials</span></a></li><li class=menu-item-press><a href=/press/><span>Press</span></a></li><li class=menu-item-team><a href=https://personalrobotics.cs.washington.edu/people/><span>Team</span></a></li><li class=menu-item-forum><a href=https://github.com/prl-mushr/mushr/discussions><span>Community Forum</span></a></li><li class=menu-item-contact><a href=/contact/><span>Contact</span></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" role=presentation aria-label="mobile menu trigger">
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pb-6 pt-6 pt-md-10 pb-md-10"><div class="row justify-content-start"><div class="col-12 col-md-8"><div class="tutorial tutorial-single"><h1 class=title>Multi-Agent Coordination Planner for Multi-Goal Tasks</h1><div class=content><p>Plan and control multiple MuSHR cars to different goals without collisions</p><h4 class=properties>Intermediate Tutorial | Expected duration is 30 minutes</h4><h2>By: <a href=https://www.linkedin.com/in/p-chanrun/>Podshara Chanrungmaneekul</a>, <a href=https://www.linkedin.com/in/aditmjha/>Adit Jha</a></h2><img src=/tutorials/coordination_planner/4car4task.gif width=1000><h2 id=introduction>Introduction</h2><h3 id=goal>Goal</h3><p>This tutorial will teach you how to setup the <a href=https://act.usc.edu/publications/Hoenig_AAMAS2018a.pdf>Enhanced Conflict-Based Search with Optimal Task Assignment</a> (ECBS-TA) planning algorithm on a set of MuSHR cars. ECBS-TA produces a set of collision free trajectories, one for each car, from start to goal. By the end of the tutorial, a set of cars will be able to generate paths that avoid each other.</p><h3 id=requirements>Requirements</h3><ul><li>If in sim, complete the <a href=https://mushr.io/tutorials/quickstart/>quickstart tutorial</a></li><li>If on real car, complete the <a href=https://mushr.io/tutorials/first_steps/>first steps tutorial</a></li><li>MuSHR Navigation System <a href=https://mushr.io/tutorials/mushr_navigation_system/>mushr_navigation_system</a></li></ul><h2 id=coordination-planner-problem-statement>Coordination Planner Problem Statement</h2><p>There is a team of <code>num_agents</code> MuSHR cars and a set of <code>num_goals</code> tasks. Each task requires one car to follow all of the <code>num_waypoints</code> points and stop at the last one. The environment is a grid world where the movement of the car is restricted to orthongonal movement. This approximate approach can work well when combined with the <a href=https://github.com/naughtyStark/nhttc_ros>nhttc controller</a>. The coordination planner has the ability to create an initial path for each car that is avoiding all possible collisions. This path is leveraged with the nhttc controller to adapt a car&rsquo;s path and avoid collisions in real-time if need be. The combination of these two services is more powerful than just the nhttc controller by itself as potential conflicts are sorted out prior to declaring each car&rsquo;s path. It is possible that some cars will not have any tasks and others will have multiple to complete sequentially.</p><h2 id=install>Install</h2><p>Clone repo and install the package:<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> ~/catkin_ws/src/
</span></span><span class=line><span class=cl>$ git clone https://github.com/prl-mushr/mushr_coordination.git
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> mushr_coordination
</span></span><span class=line><span class=cl>$ git clone https://github.com/whoenig/libMultiRobotPlanning.git
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> ~/catkin_ws/
</span></span><span class=line><span class=cl>$ catkin_make</span></span></code></pre></div></p><h2 id=api>API</h2><p>For adjusting params see <code>launch/mushr_coordination.launch</code> it has the environment params for the planner. Change the number of waypoints for each goal by setting parameter <code>num_waypoint</code>. Change the car team setting by editing or creating new config file.</p><h2 id=running-the-coordination-planner>Running the coordination planner</h2><p>Run the planner that will set up the environment publishers and subscribers.<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ roslaunch mushr_coordination mushr_coordination.launch cars_file:<span class=o>={</span>car<span class=err>&#39;</span>s team config file<span class=o>}</span></span></span></code></pre></div></p><p>For simulation, first launch the mushr_sim. Download the <a href=/tutorials/coordination_planner/multi_teleop.launch>multi_teleop.launch</a> to the mushr_sim repository. Run <code>rviz</code> then and subscribe to planner&rsquo;s topics. Download the <a href=/tutorials/coordination_planner/nhttc.rviz>rviz config file</a> for an out-of-box rviz setup. This setup subscribes to all the important rostopics and organizes them in categories.</p><p>Launch the mushr_sim.<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ roslaunch mushr_sim multi_teleop.launch</span></span></code></pre></div></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ rviz</span></span></code></pre></div><p>Below is the format for setting the initial position for a team of cars and a set of tasks to complete. For out-of-box examples, look at the <strong>Examples of Initializing the Planner</strong> section which utilizes files already part of the repository.<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ roslaunch mushr_coordination init_planner.launch cars_file:<span class=o>={</span>car<span class=err>&#39;</span>s team config file<span class=o>}</span> tasks_file:<span class=o>={</span>task benchmark file<span class=o>}</span></span></span></code></pre></div></p><h3 id=configuration-file-example-for-car-information>Configuration File Example for Car Information</h3><p>This <code>4cars1.yaml</code> file shows how to edit and create a config file. The file will have the number of agents (<code>num_agent</code>) following with <code>car{n}</code>&rsquo;s <code>name</code> and <code>color</code> in hex.</p><p>Note that, It would be advised to use the same config file for both <code>mushr_coordination</code> and <code>init_planner</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>num_agent: 4
</span></span><span class=line><span class=cl>car1:
</span></span><span class=line><span class=cl>    name: &#34;car1&#34;
</span></span><span class=line><span class=cl>    color: &#34;FF0000&#34; #red
</span></span><span class=line><span class=cl>car2:
</span></span><span class=line><span class=cl>    name: &#34;car2&#34;
</span></span><span class=line><span class=cl>    color: &#34;00FF00&#34; #green
</span></span><span class=line><span class=cl>car3:
</span></span><span class=line><span class=cl>    name: &#34;car3&#34;
</span></span><span class=line><span class=cl>    color: &#34;0000FF&#34; #blue
</span></span><span class=line><span class=cl>car4:
</span></span><span class=line><span class=cl>    name: &#34;car4&#34;
</span></span><span class=line><span class=cl>    color: &#34;DB921D&#34; #orange
</span></span></code></pre></div><h2 id=examples-of-initializing-the-planner>Examples of Initializing the Planner</h2><h3 id=example-1>Example #1</h3><p>In this environment, there are 4 cars and have been given 4 tasks to complete within a 5 by 3 space.<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ roslaunch mushr_coordination mushr_coordination.launch cars_file:<span class=o>=</span>4cars.yaml
</span></span><span class=line><span class=cl>$ rviz
</span></span><span class=line><span class=cl>$ roslaunch mushr_coordination init_planner.launch cars_file:<span class=o>=</span>4cars.yaml tasks_file:<span class=o>=</span>4cars4tasks5x3.yaml</span></span></code></pre></div></p><p>Each car get assigned to their respective task, in which their accumulated distance would be minimal.</p><img src=/tutorials/coordination_planner/example1.jpg width=800><h3 id=example-2>Example #2</h3><p>In this environment, there are 4 cars and have been given 6 tasks to complete within a 6 by 6 space.<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ roslaunch mushr_coordination mushr_coordination.launch cars_file:<span class=o>=</span>4cars.yaml
</span></span><span class=line><span class=cl>$ rviz
</span></span><span class=line><span class=cl>$ roslaunch mushr_coordination init_planner.launch cars_file:<span class=o>=</span>4cars.yaml tasks_file:<span class=o>=</span>4cars6tasks6x6.yaml</span></span></code></pre></div></p><p>Number of tasks is more than number of cars, so the blue car and the green car have been given one task more than the others to complete.</p><img src=/tutorials/coordination_planner/example2.jpg width=800><h3 id=example-3>Example #3</h3><p>In this environment, there are 4 cars and have been given 2 tasks to complete within a 5 by 3 space.<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ roslaunch mushr_coordination mushr_coordination.launch cars_file:<span class=o>=</span>4cars.yaml
</span></span><span class=line><span class=cl>$ rviz
</span></span><span class=line><span class=cl>$ roslaunch mushr_coordination init_planner.launch cars_file:<span class=o>=</span>4cars.yaml tasks_file:<span class=o>=</span>4cars2tasks5x3.yaml</span></span></code></pre></div></p><p>There is not enough task to assign to every cars. In this case, the red car and green car are idle and stay in place.</p><img src=/tutorials/coordination_planner/example3.jpg width=800></div></div></div></div></div><div class="strip strip-primary-gradient-top-bottom"><div class="container pt-3 pb-3 pt-md-6 pb-md-3 px-2"><div class="row justify-content-left citation-row"><h1 id=citation>Citation</h1><p>If you plan to use any part of the the MuSHR platform (including tutorials, codebase, or hardware instructions) for a project or paper, please cite
<em><a href=https://arxiv.org/abs/1908.08031>MuSHR: A Low-Cost, Open-Source Robotic Racecar for Education and Research</a></em>.</p><div class=highlight><pre class=chroma>@article{srinivasa2019mushr,
 title={{MuSHR}: A Low-Cost, Open-Source Robotic Racecar for Education and Research},
 author={Srinivasa, Siddhartha S. and Lancaster, Patrick and Michalove, Johan and Schmittle, Matt and Summers, Colin and Rockett, Matthew and Smith, Joshua R. and Chouhury, Sanjiban and Mavrogiannis, Christoforos and Sadeghi, Fereshteh},
 journal={CoRR},
 volume={abs/1908.08031},
 year={2019}
}
</pre></div><br></div></div></div></div><div class=footer><div class=container><div class=row><div class=col-12><div class=footer-inner><h3 class=footer-title>MuSHR: The UW Open Racecar Project</h3><ul><li class=menu-item-forum><a href=https://github.com/prl-mushr/mushr/discussions>Community Forum</a></li><li class=menu-item-contact><a href=/contact/>Contact</a></li><li class=menu-item-home><a href=/>Home</a></li></ul></div></div></div></div></div><div class=sub-footer><div class=container><div class=row><div class=col-12><div class=sub-footer-inner><ul></ul><ul><li class=prl>Made with <font color=#FF1690>♥</font> at the <a href=https://personalrobotics.cs.washington.edu/>Personal Robotics Lab</a></li></ul><ul><li class=prl>Website by <a href=https://micha.love/><font color=#36CDC4>Johan</font></a></li></ul></div></div></div></div></div><script type=text/javascript src=/js/scripts.min.8504133605a277da18f0d58cfd2e90d154962f4a961543a6e2f0a459a2d05462.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146151202-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-146151202-1")</script></body></html>